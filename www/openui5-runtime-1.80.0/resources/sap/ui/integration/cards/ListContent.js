/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseListContent","./ListContentRenderer","sap/m/List","sap/ui/integration/library","sap/ui/integration/util/BindingHelper","sap/ui/integration/controls/Microchart","sap/ui/integration/controls/MicrochartLegend","sap/ui/integration/controls/ListContentItem"],function(B,L,a,l,b,M,c,d){"use strict";var A=l.AreaType;var e=B.extend("sap.ui.integration.cards.ListContent",{metadata:{aggregations:{_legend:{multiple:false,visibility:"hidden"}}},renderer:L});e.prototype.init=function(){B.prototype.init.apply(this,arguments);var o=this._getList();var t=this;this.setAggregation("_content",o);o.attachUpdateFinished(function(){if(t._iVisibleItems){var I=o.getItems();for(var i=t._iVisibleItems+1;i<I.length;i++){I[i].setVisible(false);}}});this._oItemTemplate=new d({iconDensityAware:false});};e.prototype.exit=function(){B.prototype.exit.apply(this,arguments);if(this._oItemTemplate){this._oItemTemplate.destroy();this._oItemTemplate=null;}};e.prototype.loadDependencies=function(C){if(!C||!C.item||!C.item.chart){return Promise.resolve();}return M.loadDependencies();};e.prototype.destroyPlaceholder=function(){var o=this.getAggregation("_legend");if(o){o.removeStyleClass("sapFCardContentHidden");}B.prototype.destroyPlaceholder.apply(this,arguments);};e.prototype.setConfiguration=function(C){B.prototype.setConfiguration.apply(this,arguments);if(!C){return this;}if(C.items){this._setStaticItems(C.items);return this;}if(C.item){this._setItem(C.item);}return this;};e.prototype.onDataChanged=function(){this._checkHiddenNavigationItems(this.getConfiguration().item);};e.prototype._getList=function(){if(this._bIsBeingDestroyed){return null;}if(!this._oList){this._oList=new a({id:this.getId()+"-list",growing:false,showNoData:false,showSeparators:"None"});}return this._oList;};e.prototype._setItem=function(i){var s={iconDensityAware:false,title:i.title&&(i.title.value||i.title),description:i.description&&(i.description.value||i.description),highlight:i.highlight,info:i.info&&i.info.value,infoState:i.info&&i.info.state};if(i.icon&&i.icon.src){s.icon=b.formattedProperty(i.icon.src,function(v){return this._oIconFormatter.formatSrc(v,this._sAppId);}.bind(this));}if(i.chart){s.microchart=this._createChartAndAddLegend(i.chart);}this._oItemTemplate=new d(s);this._oActions.setAreaType(A.ContentItem);this._oActions.attach(i,this);var o={template:this._oItemTemplate};this._filterHiddenNavigationItems(i,o);this._bindAggregation("items",this._getList(),o);};e.prototype._createChartAndAddLegend=function(C){var o=M.create(C);this.destroyAggregation("_legend");if(C.type==="StackedBar"){var f=new c({chart:o.getChart()});f.initItemsTitles(C.bars,this.getBindingContext().getPath());this.setAggregation("_legend",f);}return o;};e.prototype._setStaticItems=function(i){var o=this._getList();i.forEach(function(I){var f=new d({iconDensityAware:false,title:I.title?I.title:"",description:I.description?I.description:"",icon:I.icon?I.icon:"",infoState:I.infoState?I.infoState:"None",info:I.info?I.info:"",highlight:I.highlight?I.highlight:"None"});if(I.action){f.setType("Navigation");if(I.action.url){f.attachPress(function(){window.open(I.action.url,I.target||"_blank");});}}o.addItem(f);});this.fireEvent("_actionContentReady");};e.prototype.getInnerList=function(){return this._getList();};return e;});
