/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/library","sap/ui/integration/cards/BaseContent","sap/m/HBox","sap/m/VBox","sap/m/Text","sap/m/Title","sap/f/Avatar","sap/m/Link","sap/m/Label","sap/ui/core/ResizeHandler","sap/ui/layout/AlignedFlowLayout","sap/ui/dom/units/Rem","sap/ui/integration/util/BindingHelper"],function(l,B,H,V,T,a,A,L,b,R,c,d,e){"use strict";var f=l.AreaType;var O=B.extend("sap.ui.integration.cards.ObjectContent",{renderer:{}});O.prototype._getRootContainer=function(){if(this._bIsBeingDestroyed){return null;}var o=this.getAggregation("_content");if(!o){o=new c();this.setAggregation("_content",o);}this._sResizeListenerId=R.register(o,this.onAlignedFlowLayoutResize.bind(this));return o;};O.prototype.onAlignedFlowLayoutResize=function(E){if(E&&(E.size.width===E.oldSize.width)&&!E.control){return;}var C=E.control,m=C.getMinItemWidth(),n=C.getContent().length,M;if(m.lastIndexOf("rem")!==-1){M=d.toPx(m);}else if(m.lastIndexOf("px")!==-1){M=parseFloat(m);}var i=Math.floor(E.size.width/M);if(i>n){i=n;}if(this._iColsOld===i){return;}this._iColsOld=i;var g=i-1,r=Math.ceil(n/i);C.getContent().forEach(function(I,h){I.addStyleClass("sapFCardObjectSpaceBetweenGroup");if(g===h&&g<n){I.removeStyleClass("sapFCardObjectSpaceBetweenGroup");g+=i;}if(h+1>(r-1)*i){I.addStyleClass("sapFCardObjectGroupLastInColumn");}else{I.removeStyleClass("sapFCardObjectGroupLastInColumn");}});};O.prototype.exit=function(){B.prototype.exit.apply(this,arguments);if(this._sResizeListenerId){R.deregister(this._sResizeListenerId);this._sResizeListenerId="";}};O.prototype.setConfiguration=function(C){B.prototype.setConfiguration.apply(this,arguments);if(!C){return this;}if(C.groups){this._addGroups(C);}return this;};O.prototype._addGroups=function(C){var o=this._getRootContainer();var g=C.groups||[];g.forEach(function(G){var h=new V().addStyleClass("sapFCardObjectGroup");var t=new a({text:G.title}).addStyleClass("sapFCardObjectItemTitle");h.addItem(t);G.items.forEach(function(i){var I,v=i.label,j=i.value,k,m,n=[];if(v){v=e.formattedProperty(v,function(u){return u&&u[u.length-1]===":"?u:u+=":";});k=new b({text:v}).addStyleClass("sapFCardObjectItemLabel");}if(j){switch(i.type){case'link':I=new L({href:i.url||j,text:j,target:i.target||'_blank'});break;case'email':if(i.value){n.push(i.value);}if(i.emailSubject){n.push(i.emailSubject);}m=e.formattedProperty(n,function(u,E){if(E){return"mailto:"+u+"?subject="+E;}else{return"mailto:"+u;}});I=new L({href:m,text:j});break;case'phone':m=e.formattedProperty(j,function(u){return"tel:"+u;});I=new L({href:m,text:j});break;default:I=new T({text:j});break;}}if(I){I.addStyleClass("sapFCardObjectItemText");}if(i.icon){var s=e.formattedProperty(i.icon.src,function(u){return this._oIconFormatter.formatSrc(u,this._sAppId);}.bind(this));var p=new A({customDisplaySize:"2.5rem",displaySize:"Custom",src:s}).addStyleClass("sapFCardObjectItemAvatar sapFCardObjectItemLabel");var q=new V({items:[k,I]});var r=new H({items:[p,q]});h.addItem(r);}else{h.addItem(k);h.addItem(I);}},this);o.addContent(h);},this);this._oActions.setAreaType(f.Content);this._oActions.attach(C,this);};return O;});
