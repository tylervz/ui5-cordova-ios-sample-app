/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/model/Filter","sap/base/Log"],function(F,a,L){"use strict";var b={createConditionTypesMapFromFilterBar:function(c,f){var r={};for(var s in c){if(f){var p=f._getPropertyByName(s);var d=p&&p.typeConfig&&p.typeConfig.typeInstance;r[s]={type:d};}}return r;},createFilters:function(c,C,f){var i,l,d,o=[],O,e,g,t,s,n,p;for(var h in c){l=[];d=[];t=null;var k=c[h];for(i=0;i<k.length;i++){g=k[i];O=F.getOperator(g.operator);if(!O){continue;}var D;if(C){if(C[h]){D=C[h].type;if(!D){L.warning("FilterConverter","Not able to retrieve the type of path '"+h+"!");}}}try{e=O.getModelFilter(g,h,D);}catch(m){L.error("FilterConverter","Not able to convert the condition for path '"+h+"' into a filter! The type is missing!");continue;}if(f){e=f(g,h,D,e);if(!e){continue;}}if(!O.exclude){if(e.sPath==="$search"){continue;}var $=/^\*(.+)\*$/.exec(e.sPath);if($){var q=$[1].split(',');for(var j=0;j<q.length;j++){l.push(new a(q[j],e.sOperator,e.oValue1));}continue;}if(e.sPath&&e.sPath.indexOf('*/')>-1){s=e.sPath.split('*/');if(s.length===2){n=s[0];p=s[1];e.sPath='L1/'+p;if(!t){t={path:n,operator:'Any',variable:'L1'};}l.push(e);}else{throw new Error("Not Implemented");}}else{l.push(e);}}else{d.push(e);}}if(t){if(l.length===1){t.condition=l[0];}else if(l.length>1){t.condition=new a({filters:l,and:false});}l=[new a(t)];}e=undefined;if(l.length===1){e=l[0];}else if(l.length>1){e=new a({filters:l,and:false});}if(e){d.unshift(e);}if(d.length===1){o.push(d[0]);}else if(d.length>1){o.push(new a({filters:d,and:true}));}}if(o.length===1){e=o[0];}else if(o.length>1){e=new a({filters:o,and:true});}else{e=null;}L.info("FilterConverter",b.prettyPrintFilters(e));return e;},prettyPrintFilters:function(f){var r;if(!f){return"";}if(f._bMultiFilter){r="";var A=f.bAnd;f.aFilters.forEach(function(f,i,c){r+=b.prettyPrintFilters(f);if(c.length-1!=i){r+=A?" and ":" or ";}},this);return"("+r+")";}else{r=f.sPath+" "+f.sOperator+" '"+f.oValue1+"'";if(f.sOperator==="BT"){r+="...'"+f.oValue2+"'";}return r;}}};return b;},true);
