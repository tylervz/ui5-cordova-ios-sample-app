/*
 * ! OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/OverflowToolbarButton","sap/m/OverflowToolbarLayoutData","sap/base/util/merge","sap/m/library","sap/m/MenuButton","sap/ui/mdc/p13n/AdaptationController","sap/ui/mdc/p13n/FlexUtil"],function(O,a,m,M,b,A,F){"use strict";var r;var T={createSortButton:function(i,e){if(!r){this._loadResourceBundle();}return this._createButton(i+"-sort",{icon:"sap-icon://sort",text:r.getText("table.SETTINGS_SORT","Sort"),press:e,tooltip:r.getText("table.SETTINGS_SORT","Sort"),layoutData:new a({closeOverflowOnInteraction:false})});},createColumnsButton:function(i,e){if(!r){this._loadResourceBundle();}return this._createButton(i+"-settings",{icon:"sap-icon://action-settings",text:r.getText("table.SETTINGS_COLUMN","Add/Remove Columns"),press:e,tooltip:r.getText("table.SETTINGS_COLUMN","Add/Remove Columns"),layoutData:new a({closeOverflowOnInteraction:false})});},createFilterButton:function(i,e){if(!r){this._loadResourceBundle();}return this._createButton(i+"-filter",{icon:"sap-icon://filter",text:r.getText("filter.PERSONALIZATION_DIALOG_TITLE","Filter"),press:e,layoutData:new a({closeOverflowOnInteraction:false})});},createExportButton:function(i,e){if(!r){this._loadResourceBundle();}var o=new b(i+"-export",{icon:"sap-icon://excel-attachment",tooltip:r.getText("table.EXPORT_BUTTON_TEXT"),type:M.ButtonType.Ghost,buttonMode:M.MenuButtonMode.Split,useDefaultActionOnly:true,defaultAction:e.default});sap.ui.getCore().loadLibrary("sap.ui.unified",{async:true}).then(function(){sap.ui.require(["sap/m/Menu","sap/m/MenuItem"],function(c,d){var f=new c({items:[new d({text:r.getText("table.QUICK_EXPORT","Export"),press:e.default}),new d({text:r.getText("table.EXPORT_WITH_SETTINGS","Export As..."),press:e.exportAs})]});o.setMenu(f);});});return o;},_createButton:function(i,s){return new O(i,s);},_loadResourceBundle:function(){r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");},showPanel:function(c,p,s,i){T["showP13n"+p](c,s);},_getAdaptationController:function(c){var R=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");if(!c._oAdaptationController){c._oAdaptationController=new A({adaptationControl:c,stateRetriever:function(){return c.getCurrentState();},afterChangesCreated:function(o,C){F.handleChanges(C);},itemConfig:{addOperation:"addColumn",removeOperation:"removeColumn",moveOperation:"moveColumn",panelPath:"sap/ui/mdc/p13n/panels/SelectionPanel",title:R.getText("table.SETTINGS_COLUMN")}});}return c._oAdaptationController;},showP13nColumns:function(c,s){var o=this._getAdaptationController(c);o.showP13n(s,"Item");},showP13nSort:function(c,s){var o=this._getAdaptationController(c);o.showP13n(s,"Sort");},_setFilterConfig:function(c){var R=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");var o=this._getAdaptationController(c);return c._retrieveP13nFilter().then(function(d){var f={filterControl:d,title:R.getText("filter.PERSONALIZATION_DIALOG_TITLE")};o.setFilterConfig(f);return d;});},showP13nFilter:function(c,s){var o=this._getAdaptationController(c);T._setFilterConfig(c).then(function(){o.showP13n(s,"Filter");});},createSort:function(c,p,R){var s={selected:true,name:p,descending:false};c.getCurrentState().sorters.forEach(function(P){if(P.name==p){s.descending=!P.descending;}});var o=this._getAdaptationController(c);var i=[s];o.createSortChanges(i,true);},moveColumn:function(c,d,n){if(d!=n){this._moveItem(c,d,n,"moveColumn");}},_moveItem:function(c,d,n,s){var v=c.getCurrentState(c).items||[];var o=v[d];var e=this._getAdaptationController(c);e.createItemChanges([{name:o.name,position:n}]);}};return T;});
