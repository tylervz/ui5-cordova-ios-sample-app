/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./CommandShortcutHints","./Popup","./InvisibleText"],function(C,P,I){"use strict";var a=function(o){this._shortcutHintOptions=o;this._attachCommand=_;this._getHintPopup=f;this._createShortcutHintPopup=j;this._getShortcutHintRef=b;this._getShortcutHintText=c;this._updateShortcutHintAccLabel=k;this.showShortcutHint=s;this.hideShortcutHint=h;};a.init=function(o){i.call(o);};function i(){this.attachEvent("EventHandlerChange",function(E){var F=E.getParameter("func");if(E.getParameter("type")==="listenerAttached"&&F&&F._sapui_commandName){this._attachCommand(F._sapui_commandName);}});}function _(n){C.register(this,n);var A={"onAfterRendering":function(){var o=g.call(this),E,t;if(o){E=document.getElementById(o);E.setAttribute("aria-keyshortcuts",this._getShortcutHintText());t=E.getAttribute("title");if(t){E.removeAttribute("title");this._titleAttribute=t;}}}};this.addEventDelegate(A,this);}function g(){if(this._shortcutHintOptions&&this._shortcutHintOptions.domrefid){return this._shortcutHintOptions.domrefid;}if(this._shortcutHintOptions&&this._shortcutHintOptions.domrefid_suffix){return this.getId()+this._shortcutHintOptions.domrefid_suffix;}return this.getId();}function b(){return document.getElementById(g.call(this));}function s(){var t,p=(this._shortcutHintOptions&&this._shortcutHintOptions.position)||"0 8",M=P.Dock.CenterTop,o=P.Dock.CenterBottom,n=this._getHintPopup(),S=this._getShortcutHintRef(),q=this._getShortcutHintText();if(!e(S)||!d(S)){return;}if(this._titleAttribute){q=this._titleAttribute+" ("+q+")";}if(!n){n=this._createShortcutHintPopup(q);}n.oContent.children[0].textContent=q;if(!n.isOpen()){n.open(1000,M,o,S,p,"flip",function(u){n.oContent.style.visibility="hidden";if(t){clearTimeout(t);}t=setTimeout(function(){if(!e(S)||!d(S)){return;}n.oContent.style.visibility="visible";},1000);n._applyPosition(n._oLastPosition);});}}function h(){var p=this._getHintPopup();if(p&&p.isOpen()){p.close();}}function c(){var o=C.getCommandForControl(this.getId());if(o){return o.shortcut;}}function d(D){var R;if(!D){return false;}R=D.getBoundingClientRect();return(R.top>=0&&R.left>=0&&R.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&R.right<=(window.innerWidth||document.documentElement.clientWidth));}function e(n){return n.offsetWidth>0||n.offsetHeight>0||n.getClientRects().length>0;}function f(){return a._popup;}function j(t){var p,o,T;o=document.createElement("span");o.classList.add("sapUiHintContainer");T=document.createElement("div");T.classList.add("sapUiHintText");T.textContent=t;o.appendChild(T);p=new P(o,false,false,false);p.setAnimations(function($,D,n){setTimeout(n,D);},function($,D,n){n();});a._popup=p;return p;}function k(){var o,n,R;if(!this._shortcutHintOptions.addAccessibilityLabel){return;}o=l();n=o.getId();R=this._getShortcutHintRef();o.setText(this._titleAttribute);if(o.getText()){m(R,"aria-describedby",n);}else{r(R,"aria-describedby",n);}}function l(){if(!a._invisibleText){a._invisibleText=new I();a._invisibleText.toStatic();}return a._invisibleText;}function m(n,A,v,p){var o=n.getAttribute(A);if(!o){n.setAttribute(A,v);return;}var q=o.split(" ");if(q.indexOf(v)==-1){p?q.unshift(v):q.push(v);n.setAttribute(A,q.join(" "));}}function r(n,A,v){var o=n.getAttribute(A)||"",p=o.split(" "),q=p.indexOf(v);if(q==-1){return;}p.splice(q,1);if(p.length){n.setAttribute(A,p.join(" "));}else{n.removeAttribute(A);}return this;}return a;});
